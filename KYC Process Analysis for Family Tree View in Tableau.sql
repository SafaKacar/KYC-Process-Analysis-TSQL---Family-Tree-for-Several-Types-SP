	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
	  GO

	  SELECT 
			--/*Grouping/Ordering W.R.T Month*/		 LEFT(DATENAME(MONTH,MonthDate),3) + ' ' + RIGHT('00' + CAST(YEAR(MonthDate) AS VARCHAR),2) 'MonthDate'	
			/*Grouping W.R.T. Days*/			    [Date]		

/* DAILY FIGURES*/
	/*Users Attempted to KYC Process*/			
	--		/*All Id Docs*/				,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType in (1,2,3,8) THEN UserKey ELSE NULL END) 'AllIDTypesUU' /*'DAILY-All ID Types (UU)' --Rakamlarda 2-3 sapma var, sebep birden fazla kimlik gibi görünüyor*/
/*All Id Docs*/						   , COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 1 THEN UserKey ELSE NULL END)
									   + COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 THEN UserKey ELSE NULL END)
									   + COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 3 THEN UserKey ELSE NULL END)
									   + COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 8 THEN UserKey ELSE NULL END) 'AllIDTypesUU' /*'DAILY-All ID Types (UU)'*/

			/*NewID Count*/				,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 1 THEN UserKey ELSE NULL END) 'NewIDUU' /*'DAILY-New ID (UU)'*/
			/*OldID Count*/				,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 THEN UserKey ELSE NULL END) /*'DAILY-Old ID (UU)'*/ 'OldIDUU'
			/*ForeignID Count*/			,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 3 THEN UserKey ELSE NULL END) /*'DAILY-Foreign ID (UU)'*/ 'ForeignIDUU'
			/*BlueCard Count*/			,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 8 THEN UserKey ELSE NULL END) /*'DAILY-Blue Card (UU)'*/ 'BlueCardUU'
			
	/*New ID - KYC Process Paths (Verified Ending)*/
			/*NewId-VerificationPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType=1 AND IsNfcSupported = 1 THEN UserKey ELSE NULL END) /*'DAILY-UU with NFC (New ID-VP)'*/ 'UUwithNFCNewIDVerificationPath'
			/*NewId-VerificationPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0	THEN UserKey ELSE NULL END) /*'DAILY-Completed NFC Scan (UU|New ID-VP)'*/ 'CompletedNFCScanUUNewIDVerificationPath'
			/*NewId-VerificationPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 /*AND UserType = 2*/ THEN UserKey ELSE NULL END) /*'DAILY-Civil Registry Service Validation Completed (UU|New ID-VP)'*/ 'CivilRegistryServiceValidationCompletedUUNewIDVerificationPath'
			/*NewId-VerificationPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 /*AND UserType = 2*/ THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (UU|New ID-VP)'*/ 'OCRFrontCompletedUUNewIDVerificationPath'
			/*NewId-VerificationPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 /*AND UserType = 2*/ THEN UserKey ELSE NULL END) /*'DAILY-OCR-Back Completed (UU|New ID-VP)'*/ 'OCRBackCompletedUUNewIDVerificationPath'
			/*NewId-VerificationPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 2*/ THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (UU|New ID-VP)'	*/ 'LivenessCompletedUUNewIDVerificationPath'	
			/*NewId-VerificationPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 AND UserType = 2 THEN UserKey ELSE NULL END) /*'DAILY-Verification Path Completed (UU|New ID)'*/ 'VerificationPathCompletedUUNewID'
			/*NewId-OVERALL Verified*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND UserType=2 THEN UserKey ELSE NULL END) /*'DAILY-Total Verified UU (All Paths|New ID)'*/ 'TotalVerifiedUUAllPathsNewID'	
			/*NewId-VerifiedPathOuters*/,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND UserType=2 THEN UserKey ELSE NULL END) - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 AND UserType = 2 THEN UserKey ELSE NULL END) /*'DAILY-Verified UU exclusive of Verification Path (New ID)'*/  'VerifiedUUexclusiveofVerificationPathNewID'

--Tarihi günlük ver (kolay) önyüz baş/başsız kullanıcılar var mı?

	/*New ID Owner with NFC Unsupported  Device (Approval Ending)*/
			/*NewId-ApprovalPath*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 1 AND IsNfcSupported = 0 THEN UserKey ELSE NULL END) /*'DAILY-UU without NFC (New ID-AP)'*/ 'UUwithoutNFCNewIDApprovalPath'
			/*NewId-ApprovalPath*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (UU|New ID-AP)'*/ 'OCRFrontCompletedUUNewIDApprovalPath'
			/*NewId-ApprovalPath*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1  THEN UserKey ELSE NULL END) /*'DAILY-OCR-Back Completed (UU|New ID-AP)'*/ 'OCRBackCompletedUUNewIDApprovalPath'
			/*NewId-ApprovalPath*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1  THEN UserKey ELSE NULL END) /*'DAILY-Civil Registry Service Validation Completed (UU|New ID-AP)'*/ 'CivilRegistryServiceValidationCompletedUUNewIDApprovalPath'
			/*NewId-ApprovalPath*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 /*AND UserType = 1*/ THEN UserKey ELSE NULL END) /*'DAILY-Hologram Video Process Completed (UU|New ID-AP)'*/ 'HologramVideoProcessCompletedUUNewIDApprovalPath'	
			/*NewId-ApprovalPath*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 1*/ THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (UU|New ID-AP)'*/ 'LivenessCompletedUUNewIDApprovalPath'		
			/*NewId-ApprovalPath*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 AND UserType = 1 THEN UserKey ELSE NULL END) /*'DAILY-Approval Path Completed (UU|New ID)'*/ 'ApprovalPathCompletedUUNewID'
			/*NewId-OVERALL Approved*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 1 AND UserType = 1 THEN UserKey ELSE NULL END) /*'DAILY-Total Approved UU (All Paths|New ID)'*/ 'TotalApprovalPathAprovedUUAllPathsNewID'			
			/*NewId-ApprovedPathOuters*/,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 1 AND UserType = 1 THEN UserKey ELSE NULL END) - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 AND UserType = 1 THEN UserKey ELSE NULL END) /*'DAILY-Approved UU exclusive of Approval Path (New ID)'*/ 'ApprovedUUexclusiveofApprovalPathNewID'
	/*Old ID - KYC Process Paths (Approval Ending Only)*/
			/*OldId-ApprovalPath*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND OpType=0 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (UU|Old ID-AP)'*/ 'OCRFrontCompletedUUOldIDApprovalPath'
			/*OldId-ApprovalPath*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND OpType=0 AND VerifiedIdentity=1 THEN UserKey ELSE NULL END) /*'DAILY-Civil Registry Service Validation Completed (UU|Old ID-VP)'*/ 'CivilRegistryServiceValidationCompletedUUOldIDApprovalPath'
			/*OldId-ApprovalPath*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (UU|Old ID-AP)'*/ 'LivenessCompletedUUOldIDApprovalPath'
			/*OldId-ApprovalPath*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END) /*'DAILY-Approval Path Completed (UU|Old ID)'*/ 'ApprovalPathCompletedUUOldID'
			/*OldId-OVERALL Approved*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND UserType=1 THEN UserKey ELSE NULL END) /*'DAILY-Total Approved UU (All Paths|Old ID)'*/ 'TotalApprovedUUAllPathsOldID'
			/*OldId-OVERALL Approved*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND UserType=1 THEN UserKey ELSE NULL END)-COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END) /*'DAILY-Approved UU exclusive of Approval Path (Old ID)'*/ 'ApprovedUUexclusiveofApprovalPathOldID'
			/*OldId-ApprovedPathOutliers*/ 
			
	/*Foreign ID - KYC Process Paths (Approval Ending Only)*/
			/*ForeignId-ApprovalPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (UU|Foreign ID-AP)'*/ 'OCRFrontCompletedUUForeignIDApprovalPath'
			/*ForeignId-ApprovalPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 AND VerifiedIdentity=1 THEN UserKey ELSE NULL END) /*'DAILY-Civil Registry Service Validation Completed (UU|Foreign ID-VP)'*/ 'CivilRegistryServiceValidationCompletedUUForeignIDApprovalPath'
			/*ForeignId-ApprovalPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END) /*'DAILY-Total Approved UU (All Paths|Foreign ID-AP)'*/ 'TotalApprovedUUAllPathsForeignIDApprovalPath'
			/*ForeignId-ApprovalPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END) /*'DAILY-Approval Path Completed (UU|Foreign ID)'*/ 'ApprovalPathCompletedUUForeignID'
			/*ForeignId-OVERALL Approved*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 3 AND UserType=1 THEN UserKey ELSE NULL END) /*'DAILY-Total Approved UU (All Paths|Foreign ID)'*/ 'TotalApprovedUUAllPathsForeignID'
			/*ForeignId-ApprovedPathOuters*/,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 3 AND UserType=1 THEN UserKey ELSE NULL END) - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END) /*'DAILY-Approved UU exclusive of Approval Path (Foreign ID)'*/ 'ApprovedUUexclusiveofApprovalPathForeignID'
			
	/*Blue Card - KYC Process Paths (Approval Ending Only)*/
			/*BlueCard-ApprovalPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (UU|Blue Card)'*/ 'OCRFrontCompletedUUBlueCard'
			/*BlueCard-ApprovalPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 AND VerifiedIdentity=1 THEN UserKey ELSE NULL END) /*'DAILY-Civil Registry Service Validation Completed (UU|Blue Card-AP)'*/ 'CivilRegistryServiceValidationCompletedUUBlueCardApprovalPath'
			/*BlueCard-ApprovalPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (UU|Blue Card-AP)'*/ 'LivenessCompletedUUBlueCardApprovalPath'
			/*BlueCard-ApprovalPath*/	,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END) /*'DAILY-Approval Path Completed (UU|Blue Card)'*/ 'ApprovalPathCompletedUUBlueCard'
			/*BlueCard-OVERALL*/		,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 8 AND UserType=1 THEN UserKey ELSE NULL END) /*'DAILY-Total Approved UU (All Paths|Blue Card)'*/ 'TotalApprovedUUAllPathsBlueCard'
			/*BlueCard-ApprovedPathOuters*/ ,COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 8 AND UserType=1 THEN UserKey ELSE NULL END) - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END) /*'DAILY-Approved UU exclusive of Approval Path (Blue Card)'*/ 'ApprovedUUexclusiveofApprovalPathBlueCard'


	/* STEP PAIN PARAMETERS */
			--/*New ID - KYC Process Paths (Verified Ending-TrialsUptoSuccess AKA Pain upto pass this step)*/

			/*NewId-VerificationPath-TrialsUptoSuccess*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-OCR-Front Completed (#(Pain)|New ID-VP)'*/ 'OCRFrontCompletedCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-OCR-Back Completed (#(Pain)|New ID-VP)'*/ 'OCRBackCompletedCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-Liveness Completed (#(Pain)|New ID-VP)'*/ 'LivenessCompletedCountPainNewIDVerificationPath'		

			/*New ID Owner with NFC Unsupported  Device (Approval Ending-TrialsUptoSuccess AKA Pain parameter upto pass this step)*/
			/*NewId-ApprovalPath-TrialsUptoSuccess*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-OCR-Front Completed (#(Pain)|New ID-AP)'*/ 'OCRFrontCompletedCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-OCR-Back Completed (#(Pain)|New ID-AP)'*/ 'OCRBackCompletedCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3  THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-Hologram Video Process Completed (#(Pain)|New ID-AP)'*/ 'HologramVideoProcessCompletedCountPainNewIDApprovalPath'	
			/*NewId-ApprovalPath-TrialsUptoSuccess*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-Liveness Completed (#(Pain)|New ID-AP)'*/ 'LivenessCompletedCountPainNewIDApprovalPath'		
			/*Old ID - KYC Process Paths (Approval Ending Only)*/
			/*OldId-ApprovalPath-TrialsUptoSuccess*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-OCR-Front Completed (#(Pain)|Old ID-AP)'*/ 'OCRFrontCompletedCountPainOldIDApprovalPath'
			/*OldId-ApprovalPath-TrialsUptoSuccess*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-Liveness Completed (#(Pain)|Old ID-AP)'*/ 'LivenessCompletedCountPainOldIDApprovalPath'
			
			--/*Foreign ID - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess AKA Pain parameter upto pass this step)*/
			/*ForeignId-ApprovalPath-TrialsUptoSuccess*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-OCR-Front Completed (#(Pain)|Foreign ID-AP)'*/ 'OCRFrontCompletedCountPainForeignIDApprovalPath'
			/*ForeignId-ApprovalPath-TrialsUptoSuccess*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-Liveness Completed (#(Pain)|Foreign ID-AP)'*/ 'LivenessCompletedCountPainForeignIDApprovalPath'


			
			--/*Blue Card - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess AKA Pain parameter upto pass this step)*/
			/*BlueCard-ApprovalPath-TrialsUptoSuccess*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-OCR-Front Completed (#(Pain)|Blue Card-AP)'*/ 'OCRFrontCompletedCountPainBlueCardApprovalPath'
			/*BlueCard-ApprovalPath-TrialsUptoSuccess*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END) /*'DAILY-Liveness Completed (#(Pain)|Blue Card-AP)'*/ 'LivenessCompletedCountPainBlueCardApprovalPath'

	/* STEP PAIN INDICATORS */
			--/*New ID - KYC Process Paths (Verified Ending-TrialsUptoSuccess PAIN INDICATORS)*/

			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (φ(#) Pain|New ID-VP)'*/ 'OCRFrontCompletedRateCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 /*AND UserType = 2*/ THEN UserKey ELSE NULL END) /* ''DAILY-OCR-Back Completed (φ(#) Pain|New ID-VP)'*/ 'OCRBackCompletedRateCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 2*/ THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (φ(#) Pain|New ID-VP)'*/ 'LivenessCompletedRateCountPainNewIDVerificationPath'		

			/*New ID Owner with NFC Unsupported  Device (Approval Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 /*AND UserType = 1*/ THEN UserKey ELSE NULL END) /*OCR-Front Completed (φ(#) Pain|New ID-AP)'*/ 'OCRFrontCompletedRateCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 /*AND UserType = 1*/ THEN UserKey ELSE NULL END) /*'DAILY-OCR-Back Completed (φ(#) Pain|New ID-AP)'*/ 'OCRBackCompletedRateCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3  THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 /*AND UserType = 1*/ THEN UserKey ELSE NULL END) /*'DAILY-Hologram Video Process Completed (φ(#) Pain|New ID-AP)'*/ 'HologramVideoProcessCompletedRateCountPainNewIDApprovalPath'	
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 1*/ THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (φ(#) Pain|New ID-AP)'*/ 'LivenessCompletedRateCountPainNewIDApprovalPath'		
			/*Old ID - KYC Process Paths (Approval Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (φ(#) Pain|Old ID-AP)'*/ 'OCRFrontCompletedRateCountPainOldIDApprovalPath'
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (φ(#) Pain|Old ID-AP)'*/ 'LivenessCompletedRateCountPainOldIDApprovalPath'
			
			--/*Foreign ID - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess PAIN INDICATORS)*/
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (φ(#) Pain|Foreign ID-AP)'*/ 'OCRFrontCompletedRateCountPainForeignIDApprovalPath'
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (φ(#) Pain|Foreign ID-AP)'*/ 'LivenessCompletedRateCountPainForeignIDApprovalPath'


			
			--/*Blue Card - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess PAIN INDICATORS)*/
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN UserKey ELSE NULL END)  /*'OCR-Front Completed (φ(#) Pain|Blue Card-AP)'*/ 'OCRFrontCompletedRateCountPainBlueCardApprovalPath'
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0 / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (φ(#) Pain|Blue Card-VP)'*/ 'LivenessCompletedRateCountPainBlueCardApprovalPath'

	/* STEP PAIN INDICATORS -DELTA */
			--/*New ID - KYC Process Paths (Verified Ending-TrialsUptoSuccess PAIN INDICATORS)*/

			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 THEN UserKey ELSE NULL END)*1.0 /*'OCR-Front Completed (Д(#) Pain|New ID-VP)'*/ 'OCRFrontCompletedDeltaCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 /*AND UserType = 2*/ THEN UserKey ELSE NULL END)*1.0 /*'OCR-Back Completed (Д(#) Pain|New ID-VP)'*/ 'OCRBackCompletedDeltaCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 2*/ THEN UserKey ELSE NULL END)*1.0 /*'Liveness Completed (Д(#) Pain|New ID-VP)'*/ 'LivenessCompletedDeltaCountPainNewIDVerificationPath'		

			/*New ID Owner with NFC Unsupported  Device (Approval Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0 /*'OCR-Front Completed (Д(#) Pain|New ID-AP)'*/ 'OCRFrontCompletedDeltaCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0 /*'OCR-Back Completed (Д(#) Pain|New ID-AP)'*/ 'OCRBackCompletedDeltaCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0 /*'Hologram Video Process Completed (Д(#) Pain|New ID-AP)'*/ 'HologramVideoProcessCompletedDeltaCountPainNewIDApprovalPath'	
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0 /*'Liveness Completed (Д(#) Pain|New ID-AP)'*/ 'LivenessCompletedDeltaCountPainNewIDApprovalPath'		
	
			/*Old ID - KYC Process Paths (Approval Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND OpType=0 THEN UserKey ELSE NULL END)*1.0 /*'OCR-Front Completed (Д(#) Pain|Old ID-AP)'*/ 'OCRFrontCompletedDeltaCountPainOldIDApprovalPath'
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0 /*'Liveness Completed (Д(#) Pain|Old ID-AP)'*/ 'LivenessCompletedDeltaCountPainOldIDApprovalPath'
			
			--/*Foreign ID - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess PAIN INDICATORS)*/
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN UserKey ELSE NULL END)*1.0 /*'OCR-Front Completed (Д(#) Pain|Foreign ID-AP)'*/ 'OCRFrontCompletedDeltaCountPainForeignIDApprovalPath'
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0 /*'Liveness Completed (Д(#) Pain|Foreign ID-AP)'*/ 'LivenessCompletedDeltaCountPainForeignIDApprovalPath'
			
			--/*Blue Card - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess PAIN INDICATORS)*/
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN UserKey ELSE NULL END)*1.0  /*'OCR-Front Completed (Д(#) Pain|Blue Card-AP)'*/ 'OCRFrontCompletedDeltaCountPainBlueCardApprovalPath'
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0 /*'Liveness Completed (Д(#) Pain|Blue Card-VP)'*/ 'LivenessCompletedDeltaCountPainBlueCardApprovalPath'

	/* STEP PAIN INDICATORS -DELTA% */
			--/*New ID - KYC Process Paths (Verified Ending-TrialsUptoSuccess PAIN INDICATORS)*/

			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 THEN UserKey ELSE NULL END)*1.0) / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (Д%(#) Pain|New ID-VP)'*/ 'OCRFrontCompletedDeltaPercentageCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 /*AND UserType = 2*/ THEN UserKey ELSE NULL END)*1.0) / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 /*AND UserType = 2*/ THEN UserKey ELSE NULL END) /*'DAILY-OCR-Back Completed (Д%(#) Pain|New ID-VP)'*/ 'OCRBackCompletedDeltaPercentageCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 2*/ THEN UserKey ELSE NULL END)*1.0) /  COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 2*/ THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (Д%(#) Pain|New ID-VP)'*/ 'LivenessCompletedDeltaPercentageCountPainNewIDVerificationPath'		

			
			/*New ID Owner with NFC Unsupported  Device (Approval Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep = 1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 THEN UserKey ELSE NULL END)*1.0) / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (Д%(#) Pain|New ID-AP)'*/ 'OCRFrontCompletedDeltaPercentageCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep = 1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 THEN UserKey ELSE NULL END)*1.0) / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Back Completed (Д%(#) Pain|New ID-AP)'*/ 'OCRBackCompletedDeltaPercentageCountPainNewIDApprovalPath'
																		,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)) / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 /*AND UserType = 1*/ THEN UserKey ELSE NULL END) /*'DAILY-Hologram Video Process Completed (Д%(#) Pain|New ID-AP)'*/ 'HologramVideoProcessCompletedDeltaPercentageCountPainNewIDApprovalPath'
																		,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0)  / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0 /*'Liveness Completed (Д%(#) Pain|New ID-AP)'*/ 'LivenessCompletedDeltaPercentageCountPainNewIDApprovalPath'	

			/*Old ID - KYC Process Paths (Approval Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN UserKey ELSE NULL END)*1.0) / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (Д%(#) Pain|Old ID-AP)'*/ 'OCRFrontCompletedDeltaPercentageCountPainOldIDApprovalPath'
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0) / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (Д%(#) Pain|Old ID-AP)'*/ 'LivenessCompletedDeltaPercentageCountPainOldIDApprovalPath'
			
			--/*Foreign ID - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess PAIN INDICATORS)*/
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN UserKey ELSE NULL END)*1.0) / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN UserKey ELSE NULL END) /*'DAILY-OCR-Front Completed (Д%(#) Pain|Foreign ID-AP)'*/ 'OCRFrontCompletedDeltaPercentageCountPainForeignIDApprovalPath'
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0) / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (Д%(#) Pain|Foreign ID-AP)'*/ 'LivenessCompletedDeltaPercentageCountPainForeignIDApprovalPath'

			--/*Blue Card - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess PAIN INDICATORS)*/
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN UserKey ELSE NULL END)*1.0) / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN UserKey ELSE NULL END)  /*'OCR-Front Completed (Д%(#) Pain|Blue Card-AP)'*/ 'OCRFrontCompletedDeltaPercentageCountPainBlueCardApprovalPath'
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0) / COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END) /*'DAILY-Liveness Completed (Д%(#) Pain|Blue Card-VP)'*/ 'LivenessCompletedDeltaPercentageCountPainBlueCardApprovalPath'


		/*UNSUCCESSFUL STEP PAIN TIME AVG ON UNSUCCESSFUL STEPS */
			--/*New ID - KYC Process Paths (Verified Ending-TrialTimeAvginSecond AKA Pain Time Avg upto pass this step)*/

			/*NewId-VerificationPath-TrialTimeAvginSecond*/	,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Front Completed (Avg. Pain Time in Second|New ID-VP)'*/ 'OCRFrontCompletedAvgPainTimeinSecondNewIDVerificationPath'
			/*NewId-VerificationPath-TrialTimeAvginSecond*/	,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Back Completed (Avg. Pain Time in Second|New ID-VP)'*/ 'OCRBackCompletedAvgPainTimeinSecondNewIDVerificationPath'
			/*NewId-VerificationPath-TrialTimeAvginSecond*/	,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-Liveness Completed (Avg. Pain Time in Second|New ID-VP)'*/ 'LivenessCompletedAvgPainTimeinSecondNewIDVerificationPath'		

			/*New ID Owner with NFC Unsupported  Device (Approval Ending-TrialTimeAvginSecond AKA Pain Time Avg  parameter upto pass this step)*/
			/*NewId-ApprovalPath-TrialTimeAvginSecond*/		,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Front Completed (Avg. Pain Time in Second|New ID-AP)'*/ 'OCRFrontCompletedAvgPainTimeinSecondNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialTimeAvginSecond*/		,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Back Completed (Avg. Pain Time in Second|New ID-AP)'*/ 'OCRBackCompletedAvgPainTimeinSecondNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialTimeAvginSecond*/		,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-Hologram Video Process Completed (Avg. Pain Time in Second|New ID-AP)'*/ 'HologramVideoProcessCompletedAvgPainTimeinSecondNewIDApprovalPath'	
			/*NewId-ApprovalPath-TrialTimeAvginSecond*/		,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-Liveness Completed (Avg. Pain Time in Second|New ID-AP)'*/ 'LivenessCompletedAvgPainTimeinSecondNewIDApprovalPath'		
			/*Old ID - KYC Process Paths (Approval Ending Only)*/
			/*OldId-ApprovalPath-TrialTimeAvginSecond*/		,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Front Completed (Avg. Pain Time in Second|Old ID-AP)'*/ 'OCRFrontCompletedAvgPainTimeinSecondOldIDApprovalPath'
			/*OldId-ApprovalPath-TrialTimeAvginSecond*/		,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-Liveness Completed (Avg. Pain Time in Second|Old ID-AP)'*/ 'LivenessCompletedAvgPainTimeinSecondOldIDApprovalPath'
			
			--/*Foreign ID - KYC Process Paths (Approval Ending Only-TrialTimeAvginSecond AKA v parameter upto pass this step)*/
			/*ForeignId-ApprovalPath-TrialTimeAvginSecond*/	,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Front Completed (Avg. Pain Time in Second|Foreign ID-AP)'*/ 'OCRFrontCompletedAvgPainTimeinSecondForeignIDApprovalPath'
			/*ForeignId-ApprovalPath-TrialTimeAvginSecond*/	,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-Liveness Completed (Avg. Pain Time in Second|Foreign ID-AP)'*/ 'LivenessCompletedAvgPainTimeinSecondForeignIDApprovalPath'

						--/*Blue ID - KYC Process Paths (Approval Ending Only-TrialTimeAvginSecond AKA v parameter upto pass this step)*/
			/*BlueCardId-ApprovalPath-TrialTimeAvginSecond*/	,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Front Completed (Avg. Pain Time in Second|Blue ID-AP)'*/ 'OCRFrontCompletedAvgPainTimeinSecondBlueIDApprovalPath'
			/*BlueCardId-ApprovalPath-TrialTimeAvginSecond*/	,AVG(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-Liveness Completed (Avg. Pain Time in Second|Blue ID-AP)'*/ 'LivenessCompletedAvgPainTimeinSecondBlueIDApprovalPath'


		

							/*UNSUCCESSFUL STEP PAIN TIME Standard Deviation ON UNSUCCESSFUL STEPS */
			--/*New ID - KYC Process Paths (Verified Ending-TrialTimeSTDEVinSecond AKA Pain Time STDEV upto pass this step)*/

			--/*NewId-VerificationPath-TrialTimeSTDEVinSecond*/	,STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Front Completed (STDEV. Pain Time in Second|New ID-VP)'*/ ''
			--/*NewId-VerificationPath-TrialTimeSTDEVinSecond*/	,STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Back Completed (STDEV. Pain Time in Second|New ID-VP)'*/ ''
			--/*NewId-VerificationPath-TrialTimeSTDEVinSecond*/	,STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-Liveness Completed (STDEV. Pain Time in Second|New ID-VP)'*/ ''		

			--/*New ID Owner with NFC Unsupported  Device (Approval Ending-TrialTimeSTDEVinSecond AKA Pain Time STDEV  parameter upto pass this step)*/
			--/*NewId-ApprovalPath-TrialTimeSTDEVinSecond*/		,STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Front Completed (STDEV. Pain Time in Second|New ID-AP)'*/ ''
			--/*NewId-ApprovalPath-TrialTimeSTDEVinSecond*/		,STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Back Completed (STDEV. Pain Time in Second|New ID-AP)'*/ ''
			--/*NewId-ApprovalPath-TrialTimeSTDEVinSecond*/		,STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-Hologram Video Process Completed (STDEV. Pain Time in Second|New ID-AP)'*/ ''	
			--/*NewId-ApprovalPath-TrialTimeSTDEVinSecond*/		,STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-Liveness Completed (STDEV. Pain Time in Second|New ID-AP)'*/ ''		
			--/*Old ID - KYC Process Paths (Approval Ending Only)*/
			--/*OldId-ApprovalPath-TrialTimeSTDEVinSecond*/		,STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Front Completed (STDEV. Pain Time in Second|Old ID-AP)'*/ ''
			--/*OldId-ApprovalPath-TrialTimeSTDEVinSecond*/		,STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-Liveness Completed (STDEV. Pain Time in Second|Old ID-AP)'*/ ''
			
			----/*Foreign ID - KYC Process Paths (Approval Ending Only-TrialTimeSTDEVinSecond AKA STD parameter upto pass this step)*/
			--/*ForeignId-ApprovalPath-TrialTimeSTDEVinSecond*/	,STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-OCR-Front Completed (STDEV. Pain Time in Second|Foreign ID-AP)'*/ ''
			--/*ForeignId-ApprovalPath-TrialTimeSTDEVinSecond*/	,STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END) /*'DAILY-Liveness Completed (STDEV. Pain Time in Second|Foreign ID-AP)'*/ ''

			----/*BlueCard - KYC Process Paths (Approval Ending Only-TrialTimeSTDEVinSecond AKA STD parameter upto pass this step)*/
			--/*BlueCard-ApprovalPath-TrialTimeSTDEVinSecond*/	,NULLIF(STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END),0) /*'DAILY-OCR-Front Completed (STDEV. Pain Time in Second|BlueCard-AP)'*/ ''
			--/*BlueCard-ApprovalPath-TrialTimeSTDEVinSecond*/	,NULLIF(STDEV(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END),0) /*'DAILY-Liveness Completed (STDEV. Pain Time in Second|BlueCard-AP)'*/ ''

/* MONTHLY FIGURES*/
	/*Users Attempted to KYC Process*/			
			/*All Id Docs*/				,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType in (1,2,3,8) THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])  /*'MONTHLY-All ID Types (UU)'*/ 'MTDAllIDTypesUU'
			/*NewID Count*/				,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-New ID (UU)'*/ 'MTDNewIDUU'
			/*OldID Count*/				,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Old ID (UU)'*/ 'MTDOldIDUU'
			/*ForeignID Count*/			,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 3 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Foreign ID (UU)'*/ 'MTDForeignIDUU'
			/*BlueCard Count*/			,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 8 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Blue Card (UU)'*/ 'MTDBlueCardUU'
			
	/*New ID - KYC Process Paths (Verified Ending)*/
			/*NewId-VerificationPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 1 AND IsNfcSupported = 1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-UU with NFC (New ID-VP)'*/ 'MTDUUwithNFCNewIDVerificationPath'
			/*NewId-VerificationPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0	THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Completed NFC Scan (UU|New ID-VP)'*/ 'MTDCompletedNFCScanUUNewIDVerificationPath'
			/*NewId-VerificationPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 /*AND UserType = 2*/ THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Civil Registry Service Validation Completed (UU|New ID-VP)'*/ 'MTDCivilRegistryServiceValidationCompletedUUNewIDVerificationPath'
			/*NewId-VerificationPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 /*AND UserType = 2*/ THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Front Completed (UU|New ID-VP)'*/ 'MTDOCRFrontCompletedUUNewIDVerificationPath'
			/*NewId-VerificationPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 /*AND UserType = 2*/ THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Back Completed (UU|New ID-VP)'*/ 'MTDOCRBackCompletedUUNewIDVerificationPath'
			/*NewId-VerificationPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 2*/ THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Liveness Completed (UU|New ID-VP)'*/ 'MTDLivenessCompletedUUNewIDVerificationPath'		
			/*NewId-VerificationPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 AND UserType = 2 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Verification Path Completed (UU|New ID)'*/ 'MTDVerificationPathCompletedUUNewID'
			/*NewId-OVERALL Verified*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND UserType=2 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Total Verified UU (All Paths|New ID)'*/ 'MTDTotalVerifiedUUAllPathsNewID'	
			/*NewId-VerifiedPathOuters*/,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND UserType=2 THEN UserKey ELSE NULL END) - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 AND UserType = 2 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Verified UU exclusive of Verification Path (New ID)'*/ 'MTDVerifiedUUexclusiveofVerificationPathNewID'

--Tarihi günlük ver (kolay) önyüz baş/başsız kullanıcılar var mı?			--ATOMİK TEST / --Sanity check

	/*New ID Owner with NFC Unsupported  Device (Approval Ending)*/
			/*NewId-ApprovalPath*/		,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 1 AND IsNfcSupported = 0 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-UU without NFC (New ID-AP)'*/ 'MTDUUwithoutNFCNewIDApprovalPath'
			/*NewId-ApprovalPath*/		,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Front Completed (UU|New ID-AP)'*/ 'MTDOCRFrontCompletedUUNewIDApprovalPath'
			/*NewId-ApprovalPath*/		,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Back Completed (UU|New ID-AP)'*/ 'MTDOCRBackCompletedUUNewIDApprovalPath'
			/*NewId-ApprovalPath*/		,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Civil Registry Service Validation Completed (UU|New ID-AP)'*/ 'MTDCivilRegistryServiceValidationCompletedUUNewIDApprovalPath'
			/*NewId-ApprovalPath*/		,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Hologram Video Process Completed (UU|New ID-AP)'*/ 'MTDHologramVideoProcessCompletedUUNewIDApprovalPath'	
			/*NewId-ApprovalPath*/		,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Liveness Completed (UU|New ID-AP)'*/ 'MTDLivenessCompletedUUNewIDApprovalPath'		
			/*NewId-ApprovalPath*/		,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 AND UserType = 1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Approval Path Completed (UU|New ID)'*/ 'MTDApprovalPathCompletedUUNewID'
			/*NewId-OVERALL Approved*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 1 AND UserType = 1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Total Approved UU (All Paths|New ID)'*/ 'MTDTotalApprovedUUAllPathsNewID'			
			/*NewId-ApprovedPathOuters*/,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 1 AND UserType = 1 THEN UserKey ELSE NULL END) - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 AND UserType = 1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])  /*'MONTHLY-Approved UU exclusive of Approval Path (New ID)'*/ 'MTDApprovedUUexclusiveofApprovalPathNewID'
	/*Old ID - KYC Process Paths (Approval Ending Only)*/
			/*OldId-ApprovalPath*/		,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Front Completed (UU|Old ID-AP)'*/ 'MTDOCRFrontCompletedUUOldIDApprovalPath'
			/*OldId-ApprovalPath*/		,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND OpType=0 AND VerifiedIdentity=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Civil Registry Service Validation Completed (UU|Old ID-VP)'*/ 'MTDCivilRegistryServiceValidationCompletedUUOldIDApprovalPath'
			/*OldId-ApprovalPath*/		,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Liveness Completed (UU|Old ID-AP)'*/ 'MTDLivenessCompletedUUOldIDApprovalPath'
			/*OldId-ApprovalPath*/		,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Approval Path Completed (UU|Old ID)'*/ 'MTDApprovalPathCompletedUUOldID'
			/*OldId-OVERALL Approved*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND UserType=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Total Approved UU (All Paths|Old ID)'*/ 'MTDTotalApprovedUUAllPathsOldID'
			/*OldId-OVERALL Approved*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND UserType=1 THEN UserKey ELSE NULL END)-COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Approved UU exclusive of Approval Path (Old ID)'*/ 'MTDApprovedUUexclusiveofApprovalPathOldID'
			/*OldId-ApprovedPathOutliers*/ 
			
	/*Foreign ID - KYC Process Paths (Approval Ending Only)*/
			/*ForeignId-ApprovalPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Front Completed (UU|Foreign ID-AP)'*/ 'MTDOCRFrontCompletedUUForeignIDApprovalPath'
			/*ForeignId-ApprovalPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 AND VerifiedIdentity=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Civil Registry Service Validation Completed (UU|Foreign ID-VP)'*/ 'MTDCivilRegistryServiceValidationCompletedUUForeignIDApprovalPath'
			/*ForeignId-ApprovalPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Total Approved UU (All Paths|Foreign ID-AP)'*/ 'MTDTotalApprovedUUAllPathsForeignIDApprovalPath'
			/*ForeignId-ApprovalPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Approval Path Completed (UU|Foreign ID)'*/ 'MTDApprovalPathCompletedUUForeignID'
			/*ForeignId-OVERALL Approved*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 3 AND UserType=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Total Approved UU (All Paths|Foreign ID)'*/ 'MTDTotalApprovedUUAllPathsForeignID'
			/*ForeignId-ApprovedPathOuters*/,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 3 AND UserType=1 THEN UserKey ELSE NULL END) - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Approved UU exclusive of Approval Path (Foreign ID)'*/ 'MTDApprovedUUexclusiveofApprovalPathForeignID'
			
	/*Blue Card - KYC Process Paths (Approval Ending Only)*/
			/*BlueCard-ApprovalPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Front Completed (UU|Blue Card)'*/ 'MTDOCRFrontCompletedUUBlueCard'
			/*BlueCard-ApprovalPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 AND VerifiedIdentity=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Civil Registry Service Validation Completed (UU|Blue Card-AP)'*/ 'MTDCivilRegistryServiceValidationCompletedUUBlueCardApprovalPath'
			/*BlueCard-ApprovalPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Liveness Completed (UU|Blue Card-AP)'*/ 'MTDLivenessCompletedUUBlueCardApprovalPath'
			/*BlueCard-ApprovalPath*/	,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Approval Path Completed (UU|Blue Card)'*/ 'MTDApprovalPathCompletedUUBlueCard'
			/*BlueCard-OVERALL*/			,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 8 AND UserType=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Total Approved UU (All Paths|Blue Card)'*/ 'MTDTotalApprovedUUAllPathsBlueCard'
			/*BlueCard-ApprovedPathOuters*/ ,SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 8 AND UserType=1 THEN UserKey ELSE NULL END) - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 AND UserType=1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Approved UU exclusive of Approval Path (Blue Card)'*/ 'MTDApprovedUUexclusiveofApprovalPathBlueCard'


	/* STEP PAIN PARAMETERS -MONTHLY- MTM*/
			/*New ID - KYC Process Paths (Verified Ending-TrialsUptoSuccess AKA Pain upto pass this step)*/

			/*NewId-VerificationPath-TrialsUptoSuccess*/	,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Front Completed (#(Pain)|New ID-VP)'*/ 'MTDOCRFrontCompletedCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess*/	,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Back Completed (#(Pain)|New ID-VP)'*/ 'MTDOCRBackCompletedCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess*/	,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Liveness Completed (#(Pain)|New ID-VP)'*/ 'MTDLivenessCompletedCountPainNewIDVerificationPath'		

			/*New ID Owner with NFC Unsupported  Device (Approval Ending-TrialsUptoSuccess AKA Pain parameter upto pass this step)*/
			/*NewId-ApprovalPath-TrialsUptoSuccess*/		,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Front Completed (#(Pain)|New ID-AP)'*/ 'MTDOCRFrontCompletedCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess*/		,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Back Completed (#(Pain)|New ID-AP)'*/ 'MTDOCRBackCompletedCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess*/		,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3  THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Hologram Video Process Completed (#(Pain)|New ID-AP)'*/ 'MTDHologramVideoProcessCompletedCountPainNewIDApprovalPath'	
			/*NewId-ApprovalPath-TrialsUptoSuccess*/		,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Liveness Completed (#(Pain)|New ID-AP)'*/ 'MTDLivenessCompletedCountPainNewIDApprovalPath'		


--/*NewId-ApprovalPath-TrialsUptoSuccess*/		
			/*Old ID - KYC Process Paths (Approval Ending Only)*/
			/*OldId-ApprovalPath-TrialsUptoSuccess*/		,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Front Completed (#(Pain)|Old ID-AP)'*/ 'MTDOCRFrontCompletedCountPainOldIDApprovalPath'
			/*OldId-ApprovalPath-TrialsUptoSuccess*/		,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Liveness Completed (#(Pain)|Old ID-AP)'*/ 'MTDLivenessCompletedCountPainOldIDApprovalPath'
			
			--/*Foreign ID - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess AKA Pain parameter upto pass this step)*/
			/*ForeignId-ApprovalPath-TrialsUptoSuccess*/	,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Front Completed (#(Pain)|Foreign ID-AP)'*/ 'MTDOCRFrontCompletedCountPainForeignIDApprovalPath'
			/*ForeignId-ApprovalPath-TrialsUptoSuccess*/	,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Liveness Completed (#(Pain)|Foreign ID-AP)'*/ 'MTDLivenessCompletedCountPainForeignIDApprovalPath'


			
			--/*Blue Card - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess AKA Pain parameter upto pass this step)*/
			/*BlueCard-ApprovalPath-TrialsUptoSuccess*/	,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-OCR-Front Completed (#(Pain)|Blue Card-AP)'*/ 'MTDOCRFrontCompletedCountPainBlueCardApprovalPath'
			/*BlueCard-ApprovalPath-TrialsUptoSuccess*/	,SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) /*'MONTHLY-Liveness Completed (#(Pain)|Blue Card-AP)'*/ 'MTDLivenessCompletedCountPainBlueCardApprovalPath'


	/* STEP PAIN INDICATORS-MONTHLY */
			--/*New ID - KYC Process Paths (Verified Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (	SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (φ(#) Pain|New ID-VP)'*/ 'MTDOCRFrontCompletedRateCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /	(	SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 /*AND UserType = 2*/ THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Back Completed (φ(#) Pain|New ID-VP)'*/ 'MTDOCRBackCompletedRateCountPainNewIDVerificationPath'

			/*New ID Owner with NFC Unsupported  Device -MONTHLY-MTM (Approval Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 /*AND UserType = 1*/ THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (φ(#) Pain|New ID-AP)'*/ 'MTDOCRFrontCompletedRateCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 /*AND UserType = 1*/ THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Back Completed (φ(#) Pain|New ID-AP)'*/ 'MTDOCRBackCompletedRateCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3  THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 /*AND UserType = 1*/ THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Hologram Video Process Completed (φ(#) Pain|New ID-AP)'*/ 'MTDHologramVideoProcessCompletedRateCountPainNewIDApprovalPath'	
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 1*/ THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (φ(#) Pain|New ID-AP)'*/ 'MTDLivenessCompletedRateCountPainNewIDApprovalPath'		
			
			/*Old ID - KYC Process Paths (Approval Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (φ(#) Pain|Old ID-AP)'*/ 'MTDOCRFrontCompletedRateCountPainOldIDApprovalPath'
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (φ(#) Pain|Old ID-AP)'*/ 'MTDLivenessCompletedRateCountPainOldIDApprovalPath'
			
			--/*Foreign ID - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess PAIN INDICATORS)*/
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (φ(#) Pain|Foreign ID-AP)'*/ 'MTDOCRFrontCompletedRateCountPainForeignIDApprovalPath'
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (φ(#) Pain|Foreign ID-AP)'*/ 'MTDLivenessCompletedRateCountPainForeignIDApprovalPath'


			
			--/*Blue Card - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess-MONTHLY-MTM PAIN INDICATORS)*/
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	)  /*'MONTHLY-OCR-Front Completed (φ(#) Pain|Blue Card-AP)'*/ 'MTDOCRFrontCompletedRateCountPainBlueCardApprovalPath'
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END))  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (φ(#) Pain|Blue Card-VP)'*/ 'MTDLivenessCompletedRateCountPainBlueCardApprovalPath'


			--/*New ID - KYC Process Paths (Verified Ending-TrialsUptoSuccess-MONTHLY-MTM PAIN INDICATORS)*/

			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (Д(#) Pain|New ID-VP)'*/ 'MTDOCRFrontCompletedDeltaCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 /*AND UserType = 2*/ THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Back Completed (Д(#) Pain|New ID-VP)'*/ 'MTDOCRBackCompletedDeltaCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 2*/ THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (Д(#) Pain|New ID-VP)'*/ 'MTDLivenessCompletedDeltaCountPainNewIDVerificationPath'		

			/*New ID Owner with NFC Unsupported  Device (Approval Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (Д(#) Pain|New ID-AP)'*/ 'MTDOCRFrontCompletedDeltaCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Back Completed (Д(#) Pain|New ID-AP)'*/ 'MTDOCRBackCompletedDeltaCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Hologram Video Process Completed (Д(#) Pain|New ID-AP)'*/ 'MTDHologramVideoProcessCompletedDeltaCountPainNewIDApprovalPath'	
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (Д(#) Pain|New ID-AP)'*/ 'MTDLivenessCompletedDeltaCountPainNewIDApprovalPath'		
	
			/*Old ID - KYC Process Paths (Approval Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (Д(#) Pain|Old ID-AP)'*/ 'MTDOCRFrontCompletedDeltaCountPainOldIDApprovalPath'
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (Д(#) Pain|Old ID-AP)'*/ 'MTDLivenessCompletedDeltaCountPainOldIDApprovalPath'
			
			--/*Foreign ID - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess PAIN INDICATORS)*/
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (Д(#) Pain|Foreign ID-AP)'*/ 'MTDOCRFrontCompletedDeltaCountPainForeignIDApprovalPath'
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (Д(#) Pain|Foreign ID-AP)'*/ 'MTDLivenessCompletedDeltaCountPainForeignIDApprovalPath'
			
			--/*Blue Card - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess PAIN INDICATORS)*/
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	)  /*'MONTHLY-OCR-Front Completed (Д(#) Pain|Blue Card-AP)'*/ 'MTDOCRFrontCompletedDeltaCountPainBlueCardApprovalPath'
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (Д(#) Pain|Blue Card-VP)'*/ 'MTDLivenessCompletedDeltaCountPainBlueCardApprovalPath'

	/* STEP PAIN INDICATORS -MONTHLY-MTM -DELTA% */
			--/*New ID - KYC Process Paths (Verified Ending-TrialsUptoSuccess MONTHLY- MTM PAIN INDICATORS)*/

			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (Д%(#) Pain|New ID-VP)'*/ 'MTDOCRFrontCompletedDeltaPercentageCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Back Completed (Д%(#) Pain|New ID-VP)'*/ 'MTDOCRBackCompletedDeltaPercentageCountPainNewIDVerificationPath'
			/*NewId-VerificationPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 2*/ THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (Д%(#) Pain|New ID-VP)'*/ 'MTDLivenessCompletedDeltaPercentageCountPainNewIDVerificationPath'		

						/*New ID Owner with NFC Unsupported  Device (Approval Ending-TrialsUptoSuccess PAIN INDICATORS)*/
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0  THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep = 1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (Д%(#) Pain|New ID-AP)'*/ 'MTDOCRFrontCompletedDeltaPercentageCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1  THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep = 1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Back Completed (Д%(#) Pain|New ID-AP)'*/ 'MTDOCRBackCompletedDeltaPercentageCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Hologram Video Process Completed (Д%(#) Pain|New ID-AP)'*/ 'MTDHologramVideoProcessCompletedDeltaPercentageCountPainNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4  THEN SuccessedStepTrials ELSE NULL END)*1.0 - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 /*AND UserType = 1*/ THEN UserKey ELSE NULL END)*1.0) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (Д%(#) Pain|New ID-AP)'*/ 'MTDLivenessCompletedDeltaPercentageCountPainNewIDApprovalPath'	

			/*Old ID - KYC Process Paths (Approval Ending-TrialsUptoSuccess MONTHLY- MTM PAIN INDICATORS)*/
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (Д%(#) Pain|Old ID-AP)'*/ 'MTDOCRFrontCompletedDeltaPercentageCountPainOldIDApprovalPath'
			/*OldId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/		,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (Д%(#) Pain|Old ID-AP)'*/ 'MTDLivenessCompletedDeltaPercentageCountPainOldIDApprovalPath'

			--/*Foreign ID - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess MONTHLY- MTM PAIN INDICATORS)*/
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-OCR-Front Completed (Д%(#) Pain|Foreign ID-AP)'*/ 'MTDOCRFrontCompletedDeltaPercentageCountPainForeignIDApprovalPath'
			/*ForeignId-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (Д%(#) Pain|Foreign ID-AP)'*/ 'MTDLivenessCompletedDeltaPercentageCountPainForeignIDApprovalPath'

			--/*Blue Card - KYC Process Paths (Approval Ending Only-TrialsUptoSuccess MONTHLY- MTM PAIN INDICATORS)*/
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	)  /*'MONTHLY-OCR-Front Completed (Д%(#) Pain|Blue Card-AP)'*/ 'MTDOCRFrontCompletedDeltaPercentageCountPainBlueCardApprovalPath'
			/*BlueCard-ApprovalPath-TrialsUptoSuccess_PAIN-Monthly-MTM INDICATOR*/	,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN SuccessedStepTrials ELSE NULL END)*1.0  - COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)*1.0)  OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) / (SUM(COUNT(DISTINCT CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 THEN UserKey ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date]) 	) /*'MONTHLY-Liveness Completed (Д%(#) Pain|Blue Card-VP)'*/ 'MTDLivenessCompletedDeltaPercentageCountPainBlueCardApprovalPath'


		/*UNSUCCESSFUL STEP PAIN TIME AVG ON UNSUCCESSFUL STEPS MONTHLY- MTM*/
			--/*New ID - KYC Process Paths (Verified Ending-TrialTimeAvginSecond MONTHLY- MTM AKA Pain Time Avg upto pass this step)*/
			/*NewId-VerificationPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 0 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-OCR-Front Completed (Avg. Pain Time in Second|New ID-VP)'*/ 'MTDOCRFrontCompletedAvgPainTimeinSecondNewIDVerificationPath'
			/*NewId-VerificationPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 1 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-OCR-Back Completed (Avg. Pain Time in Second|New ID-VP)'*/ 'MTDOCRBackCompletedAvgPainTimeinSecondNewIDVerificationPath'
			/*NewId-VerificationPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 1 AND IsNFCFail = 0 AND VerifiedIdentity=1 AND OpType = 4 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-Liveness Completed (Avg. Pain Time in Second|New ID-VP)'*/ 'MTDLivenessCompletedAvgPainTimeinSecondNewIDVerificationPath'


			/*New ID Owner with NFC Unsupported  Device (Approval Ending-TrialTimeAvginSecond MONTHLY- MTM AKA Pain Time Avg  parameter upto pass this step)*/
			/*NewId-ApprovalPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 0 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-OCR-Front Completed (Avg. Pain Time in Second|New ID-AP)'*/ 'MTDOCRFrontCompletedAvgPainTimeinSecondNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND OpType = 1 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-OCR-Back Completed (Avg. Pain Time in Second|New ID-AP)'*/ 'MTDOCRBackCompletedAvgPainTimeinSecondNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 3 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-Hologram Video Process Completed (Avg. Pain Time in Second|New ID-AP)'*/ 'MTDHologramVideoProcessCompletedAvgPainTimeinSecondNewIDApprovalPath'
			/*NewId-ApprovalPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 1 AND IsNfcSupported = 0 AND VerifiedIdentity=1 AND OpType = 4 AND TimerOnThisStep_Second<>0  THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-Liveness Completed (Avg. Pain Time in Second|New ID-AP)'*/ 'MTDLivenessCompletedAvgPainTimeinSecondNewIDApprovalPath'

			/*Old ID Owner with NFC Unsupported  Device (Approval Ending-TrialTimeAvginSecond MONTHLY- MTM AKA Pain Time Avg  parameter upto pass this step)*/
			/*OldId-ApprovalPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  UserIdentityType = 2 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-OCR-Front Completed (Avg. Pain Time in Second|Old ID-AP)'*/ 'MTDOCRFrontCompletedAvgPainTimeinSecondOldIDApprovalPath'
			/*OldId-ApprovalPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 2 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-OCR-Back Completed (Avg. Pain Time in Second|Old ID-AP)'*/ 'MTDOCRBackCompletedAvgPainTimeinSecondOldIDApprovalPath'
		


			/*Foreign ID - KYC Process Paths (Approval Ending Only-TrialTimeAvginSecond MONTHLY- MTM AKA v parameter upto pass this step)*/
			/*ForeignId-ApprovalPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-OCR-Front Completed (Avg. Pain Time in Second|Foreign ID-AP)'*/ 'MTDOCRFrontCompletedAvgPainTimeinSecondForeignIDApprovalPath'
			/*ForeignId-ApprovalPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 3 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-Liveness Completed (Avg. Pain Time in Second|Foreign ID-AP)'*/ 'MTDLivenessCompletedAvgPainTimeinSecondForeignIDApprovalPath'

			/*Blue Card - KYC Process Paths (Approval Ending Only-TrialTimeAvginSecond MONTHLY- MTM AKA v parameter upto pass this step)*/
			/*BlueCard-ApprovalPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND OpType=0 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-OCR-Front Completed (Avg. Pain Time in Second|Blue ID-AP)'*/ 'MTDOCRFrontCompletedAvgPainTimeinSecondBlueIDApprovalPath'
			/*BlueCard-ApprovalPath-TrialTimeAvginSecondMTM*/ ,(SUM(SUM(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) / (SUM(COUNT(CASE WHEN IsUpgrade=0 AND IsLegallyBanned=0 AND  IsPassedStep=1 AND UserIdentityType = 8 AND VerifiedIdentity=1 AND OpType=4 AND TimerOnThisStep_Second<>0 THEN TimerOnThisStep_Second ELSE NULL END)) OVER (PARTITION BY MonthDate ORDER BY [Date])*1.0) /*'MONTHLY-Liveness Completed (Avg. Pain Time in Second|Blue ID-AP)'*/ 'MTDLivenessCompletedAvgPainTimeinSecondBlueIDApprovalPath'


	  FROM


							(
								SELECT DISTINCT 
											DATEADD(DAY, 1, EOMONTH(cast(max(CreatedAt) as date), -1)) 'MonthDate',
											cast(max(CreatedAt) as date) 'Date', /*Kullanıcı için son yaratılan KYC step tarihi*/
											datediff(second, min(CreatedAt), max(CreatedAt)) 'TimerOnThisStep_Second', /*Kullanıcının adımı tekrarlaması gerektiğinde geçen süre; PAIN*/
											UserKey, /*Kullanıcı Key'ini gösterir. Performans durumuna göre UserId de verilerek, kullanıcı path'inin izlenmesi sağlanabilir. Ece Pehlivanoğlu istemişti*/
											TxId, /* KYC İşlem Id'si*/
											max(TrialCommitId) MaxTrialCommitId, /*Son step'in Id'sini verir*/
											COUNT(distinct TrialCommitId) SuccessedStepTrialsInnerOneCount, --Adımda kaç kez tekrara girdi.
											SUM(COUNT(DISTINCT TrialCommitId)) OVER (PARTITION BY k.TxId,k.OpType) SuccessedStepTrials--Başarı olan KYC Path işleminde kaç kez deneme yaptı. SuccessedStepPainTrials-ANIL AĞABEY
											,UserIdentityType,--Kimlik Tipi
											case when (SUM(IsUpgrade) OVER (Partition by UserKey))!=0 then 1 else UserType end as Usertype,--UPGRADE'leri çıkarır-UPGRADE'ler için kurgu gerekirse UserType2 isimli alan iş görebilir
											OpType,
											VerifiedIdentity,--Kimlik Nüfus sisteminde onaylı mı?
											IsNFCFail,--NFC adımında failledi mi?
											IsNfcSupported,--Cihaz NFC destekl mi
											IsPassedStep,--Adımı geçti mi>aşağıdaki hesap ile oluşturulur
											IsUpgrade,
											IsLegallyBanned --Ece 0'ları istedi
											--DeviceDescription
											
								FROM
													(		/*ECE--prekcycstatuslogs'tan tx al --		*/												
																SELECT DISTINCT
																					pcr.UserKey,
																					pcr.CreatedAt,
																					pcr.Id,
																					pcr.TxId,
																					pcr.TrialCommitId,
																					pcr.IsBiggerThanThreshold, 
																					pcr.OpType,
																					pcr.UserIdentityType,
																					pki.UserType,	--
																					IsUpgrade,
																					--Case when IsUpgrade=1 then 1 else pki.UserType end as UserType, --UPGRADE FAIL ALREADY 1
																					pksALL.VerifiedIdentity,--pki.VerifiedIdentity,
																					pksALL.IsNFCFail,--pki.IsNFCFail,																					
																					pksALL.IsNFCSupported,--pki.IsNfcSupported,
																					ud.IsLegallyBanned,
																					--pki.DeviceDescription,--TOP 3 gibi bir hedef faz2--STRING_AGG gibi bir fonk ile yan yatırıp ilk üç pain cihazını söyleyebiliriz
																	
																					CASE 
																						WHEN (/**/
																								pcr.OpType in (0,1,3,4) 
																								and pcr.UserIdentityType=1
																							 ) 
																								OR 
																							(/**/
																							pcr.OpType in (0,4) 
																							and pcr.UserIdentityType in (2,3,8)
																							)
																								AND 
																							(AVG(CAST(IsBiggerThanThreshold as int)) OVER (PARTITION BY pcr.TrialCommitId))=1 THEN 1
																						ELSE 0
																					END AS IsPassedStep																				
																	FROM  /*Tablo 'UNKNOWN' EntryType'ları olmadan çekilmelidir. UNKNOWN kaydı TechSign tarafından atanıyor. Database BE kaydı kullanmıyor. Tarih kısıtı burada verilmelidir*/
																					(SELECT CreatedAt,Id,UserKey,TxId, OpType, TrialCommitId, IsBiggerThanThreshold,UserIdentityType FROM FACT_PreKycControlResults (NOLOCK) WHERE 
																																	EntryType != 'UNKNOWN' 
																																AND OpType	  IN (0,1,3,4)
																																AND UserIdentityType  IN (1,2,3,8)
																																AND CreatedAt >= CAST(GETDATE()-1 AS DATE)
																																AND CreatedAt <  CAST(GETDATE()   AS DATE))  pcr
																	/*Kullanıcının UserType bilgisi, kimlik doğrulaması, son işlem Id bilgisi buradan çekilmelidir. Bu tabloya tarih kısıtı konulmamalıdır*/
																	LEFT JOIN (select UserKey, UserType from dim_prekycinfos (NOLOCK) where CreatedAt < CAST(GETDATE() AS DATE)) pki
																							ON 
																							pcr.UserKey=pki.UserKey --Burada yalnızca UserKey alındığında 
																						--AND	pcr.TxId=pki.TxId --Son TxId'yi yakalamamızı sağladı
																							

																	LEFT JOIN (
																				  select
																					*
																				  from
																						(
																							select 
																								Userkey,
																								TxId,
																								ROW_NUMBER() OVER (partition by UserKey,IsUpgrade Order By CreatedAt desc) RowN2,--Buraya tekrar bakmak gerekiyor
																								VerifiedIdentity,
																								IsNFCFail,
																								IsNfcSupported,
																								CreatedAt,
																								IsUpgrade

																							from
																									
																										(		
																												select 
																														 pks.UserKey
																														
																														,TxId
																														,pks.VerifiedIdentity
																														,pks.IsNFCFail
																														,pks.IsNFCSupported
																														,pks.CreatedAt
																														,Case when pks.KycStatus in (100,101,102,103) then 1 
																															  
																															  else 0 end as 'IsUpgrade'
																												 from
																																		(
																																			select 
																																						 UserKey
																																						,TxId
																																						,VerifiedIdentity
																																						,IsNFCFail
																																						,IsNFCSupported
																																						,KycStatus
																																						,CreatedAt
																																					    ,ROW_NUMBER() OVER (partition by TxId Order By CreatedAt desc) RowN
																																			from FACT_PreKycStatusLogs (nolock)
																																			where   CreatedAt >= CAST(GETDATE() -1 AS DATE)
																																				AND CreatedAt <  CAST(GETDATE()    AS DATE)
																																				AND TxId IS NOT NULL
																																		) pks
																												where  RowN=1 																														
																										) u
																							) z
																				Where RowN2=1  
																				) pksALL on pcr.UserKey=pksALL.UserKey
																							AND pcr.TxId=pksALL.TxId
																					
																	LEFT JOIN DIM_Users_Details (nolock) ud ON pcr.UserKey=ud.User_Key
																	
																	WHERE	    pcr.UserIdentityType  IN (1,2,3,8) 
																				
																			
																					
																	
																	--Her optype için prekycinfos'taki TxId ile git. En sonu gör. Her optype için max TrialCommitId alıp oradaki thrshold incele.
																	
																	-- En son optype'ı al. Ondan geriye doğru git (case olabilİr)
													
																			--and pcr.userkey=333--6333-----------------------------TEST
																			--AND PCR.Userkey=333
													) k				
								--where userkey in (12682368)
								GROUP BY 
										 UserKey,
										 TxId,
										 UserIdentityType,
										 UserType,
										 OpType,VerifiedIdentity,IsNFCFail,IsNfcSupported,IsPassedStep,IsLegallyBanned, IsUpgrade
							
							) L		
GROUP BY [Date], MonthDate
ORDER BY [Date]
/*KYC Family Tree V3-END*/
	  GO
SET TRANSACTION ISOLATION LEVEL READ COMMITTED
	  GO
